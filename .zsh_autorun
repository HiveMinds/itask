source zsh_autorun_start "$(realpath "$0")" || return 0

_functions=($_functions workon run compile upload)

workon() {
    source virtualenvwrapper.sh

    workon itask
}

run() {
    pushd
    cd $base_path

    python -m itask.itask

    popd
}

compile() {
    if [ -z "$VIRTUAL_ENV" ]; then
      echo "Virtualenv not active"
      return 1
    fi

    pushd
    cd $base_path

    python3 setup.py sdist bdist_wheel

    popd
}

upload() {
    if [ -z "$VIRTUAL_ENV" ]; then
      echo "Virtualenv not active"
      return 1
    fi

    pushd
    cd $base_path

    twine upload --repository pypi dist/\*

    popd
}

source zsh_autorun_end "$(realpath "$0")"
